(this.webpackJsonpe_zonets=this.webpackJsonpe_zonets||[]).push([[8],{174:function(e,t){},178:function(e,t,r){e.exports={form:"style_form__3RTON",formTitle:"style_formTitle__33m6y",buttonOffset:"style_buttonOffset__32AHw",formText:"style_formText__3EtuQ",recovered:"style_recovered__2miMe",register:"style_register__EKmjU",auth:"style_auth__GUOtJ"}},227:function(e,t,r){"use strict";r.r(t),r.d(t,"RecoverLoginStep",(function(){return c}));var n,c,i=r(17),o=r(21),a=r(0),u=r(25),s=r.n(u),l=r(30),b=r(20),f=r(178),m=r.n(f),d=r(23),p=r(7),j=r(202),v=r.n(j),O=r(63),x=r(67),g=function(e,t){var r=e.code;return function(){var e=Object(l.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){v.a.pki.rsa.generateKeyPair({bits:2048,workers:2},function(){var i=Object(l.a)(s.a.mark((function i(o,a){var u,l,b,f,m,d;return s.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=v.a.pki.publicKeyToPem(a.publicKey),i.prev=1,i.next=4,Object(O.a)({method:"POST",url:"/recover/login/confirm",data:{code:r,pubkey:u}});case 4:b=i.sent,f=a.privateKey.decrypt(v.a.util.decode64(null===b||void 0===b||null===(l=b.data)||void 0===l?void 0:l.login),"RSA-OAEP"),n(Object(x.b)(f)),e(f),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(1),c({code:2===(null===i.t0||void 0===i.t0||null===(m=i.t0.response)||void 0===m||null===(d=m.data)||void 0===d?void 0:d.code)&&t("i18next.recoverlogin.confirm.errorcode2")});case 13:case"end":return i.stop()}}),i,null,[[1,10]])})));return function(e,t){return i.apply(this,arguments)}}())})).catch((function(e){return e})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h=r(9),_=r(28),y=r(155),T=r(149),S=r(1),N=r(66),P=function(e,t){var r=e.email;return function(){var e=Object(l.a)(s.a.mark((function e(n){var c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(O.a)({method:"POST",url:"/recover/login",data:{email:r}});case 3:c=e.sent,n(Object(N.b)(c.data.message)),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{email:1===(null===e.t0||void 0===e.t0||null===(i=e.t0.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.code)&&t("i18next.recoverlogin.input.errorcode1")});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()};!function(e){e[e.INPUT_STEP=0]="INPUT_STEP",e[e.CONFIRM_STEP=1]="CONFIRM_STEP"}(c||(c={}));var k=(n={},Object(o.a)(n,c.INPUT_STEP,(function(e){var t=e.setStep,r=Object(a.useRef)(),n=Object(T.a)().t,i=Object(h.c)(_.b.inputStage.data),o=Object(h.b)();function u(){return(u=Object(l.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.email)){e.next=5;break}return e.abrupt("return",o(P({email:r},n)));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){r.current&&r.current.focus()}),[r.current]),Object(a.useEffect)((function(){i&&(t(c.CONFIRM_STEP),o(Object(N.a)()))}),[i]),Object(S.jsx)(y.b,{onSubmit:function(e){return u.apply(this,arguments)},validate:function(e){var t={};return e.email||(t.email=n("i18next.recoverlogin.input.erroremailisrequired")),t},subscription:{submitting:!0},render:function(e){var t=e.handleSubmit;return Object(S.jsxs)("form",{className:m.a.form,onSubmit:t,children:[Object(S.jsx)("h3",{className:m.a.formTitle,children:n("i18next.recoverlogin.input.title")}),Object(S.jsx)("p",{className:m.a.formText,children:n("i18next.recoverlogin.input.informtext")}),Object(S.jsx)(y.c,{render:function(e){var t=e.submitting;return Object(S.jsx)(y.a,{name:"email",component:b.h,inputRef:r,label:n("i18next.recoverlogin.input.youremail"),id:"email-input",placeholder:n("i18next.recoverlogin.input.enteremail"),disabled:t})}}),Object(S.jsx)(y.c,{subscription:{pristine:!0,errors:!0,submitting:!0},render:function(e){var t=e.pristine,r=e.errors,c=e.submitting;return Object(S.jsx)(b.b,{colorScheme:b.c.green,className:m.a.buttonOffset,type:"submit",disabled:t||r.email||c,loading:c,children:n("i18next.recoverlogin.input.continue")})}}),Object(S.jsx)(d.b,{to:p.a.login.url,className:m.a.register,children:n("i18next.recoverlogin.input.cancel")})]})}})})),Object(o.a)(n,c.CONFIRM_STEP,(function(){var e=Object(a.useRef)(),t=Object(T.a)().t,r=Object(h.c)(_.b.confirmStage.recoveredLogin),n=Object(h.b)();function c(){return(c=Object(l.a)(s.a.mark((function e(r){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(c=r.code)){e.next=3;break}return e.abrupt("return",n(g({code:c},t)));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){e.current&&e.current.focus()}),[e.current]),Object(a.useEffect)((function(){n(Object(x.a)())}),[]),Object(S.jsx)(y.b,{onSubmit:function(e){return c.apply(this,arguments)},validate:function(e){var r={};return e.code||(r.code=t("i18next.recoverlogin.confirm.errorecodeisrequired")),r},subscription:{submitting:!0},render:function(n){var c=n.handleSubmit;return Object(S.jsxs)("form",{className:m.a.form,onSubmit:c,children:[Object(S.jsx)("h3",{className:m.a.formTitle,children:t("i18next.recoverlogin.confirm.confirmation")}),!r&&Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("p",{className:m.a.formText,children:t("i18next.recoverlogin.confirm.informtext")}),Object(S.jsx)(y.c,{render:function(r){var n=r.submitting;return Object(S.jsx)(y.a,{name:"code",component:b.h,inputRef:e,label:t("i18next.recoverlogin.confirm.code"),id:"code-input",placeholder:t("i18next.recoverlogin.confirm.entercode"),type:"number",disabled:n})}})]}),r&&Object(S.jsxs)("div",{className:m.a.recovered,children:[Object(S.jsx)("h3",{className:m.a.formTitle,children:t("i18next.recoverlogin.confirm.yourlogin")}),Object(S.jsx)("p",{className:m.a.formText,children:r})]}),r?Object(S.jsx)(d.b,{to:p.a.login.url,className:m.a.auth,children:t("i18next.recoverlogin.confirm.login")}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(y.c,{subscription:{pristine:!0,submitting:!0,errors:!0},render:function(e){var r=e.pristine,n=e.submitting,c=e.errors;return Object(S.jsx)(b.b,{colorScheme:b.c.green,className:m.a.buttonOffset,type:"submit",disabled:r||c.code||n,loading:n,children:t("i18next.recoverlogin.confirm.continue")})}}),Object(S.jsx)(d.b,{to:p.a.login.url,className:m.a.register,children:t("i18next.recoverlogin.confirm.cancel")})]})]})}})})),n);t.default=function(){var e=Object(a.useState)(c.INPUT_STEP),t=Object(i.a)(e,2),r=t[0],n=t[1],o=k[r];return Object(S.jsx)(o,{setStep:n})}}}]);
//# sourceMappingURL=recover-login.f4099f4a.chunk.js.map